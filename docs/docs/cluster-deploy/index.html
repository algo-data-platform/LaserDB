<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<title data-react-helmet="true">集群部署 | LaserDB</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="集群部署 | LaserDB"><meta data-react-helmet="true" name="description" content="机器环境初始化"><meta data-react-helmet="true" property="og:description" content="机器环境初始化"><meta data-react-helmet="true" property="og:url" content="https://algo-data-platform.github.io/LaserDB/docs/cluster-deploy"><link data-react-helmet="true" rel="shortcut icon" href="/LaserDB/img/small-logo.png"><link data-react-helmet="true" rel="canonical" href="https://algo-data-platform.github.io/LaserDB/docs/cluster-deploy"><link rel="stylesheet" href="/LaserDB/styles.a76e6df6.css">
<link rel="preload" href="/LaserDB/styles.42bb82b0.js" as="script">
<link rel="preload" href="/LaserDB/runtime~main.e1fb6fb2.js" as="script">
<link rel="preload" href="/LaserDB/main.7618bfdc.js" as="script">
<link rel="preload" href="/LaserDB/1.39450f4e.js" as="script">
<link rel="preload" href="/LaserDB/2.80131b89.js" as="script">
<link rel="preload" href="/LaserDB/42.e8a2d4b5.js" as="script">
<link rel="preload" href="/LaserDB/43.a364796b.js" as="script">
<link rel="preload" href="/LaserDB/935f2afb.49568513.js" as="script">
<link rel="preload" href="/LaserDB/17896441.c3acda63.js" as="script">
<link rel="preload" href="/LaserDB/2ace4267.aacdcd4c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/LaserDB/"><img class="navbar__logo" src="/LaserDB/img/logo.png" alt="My Site Logo"><strong class="navbar__title"></strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/LaserDB/docs/">Next</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/LaserDB/docs/">Docs</a><a class="navbar__item navbar__link" href="/LaserDB/blog">Blog</a><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/LaserDB/"><img class="navbar__logo" src="/LaserDB/img/logo.png" alt="My Site Logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link">Versions</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/LaserDB/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/LaserDB/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/LaserDB/docs/">LaserDB</a></li><li class="menu__list-item"><a class="menu__link" href="/LaserDB/docs/getting-started">快速上手</a></li><li class="menu__list-item"><a class="menu__link" href="/LaserDB/docs/comparison-to-alternatives">常见数据库对比</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">集群部署</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/LaserDB/docs/cluster-deploy">集群部署</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/LaserDB/docs/cluster-config">集群配置</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">生态工具</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/laser-client">Laser 客户端</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/laser-proxy">Laser Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/laser-transform">Laser Transform</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/LaserDB/docs/monitor">监控告警</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">教程</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/xxx">Style Guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">参考指南</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/reference/data-model">数据模型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/reference/data-shard">数据分片</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/reference/data-import">批量导入</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/reference/engine">存储引擎</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/reference/server-config">Laser Server 配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/LaserDB/docs/reference/server-error-code">错误码</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/LaserDB/docs/fqa">常见问题</a></li><li class="menu__list-item"><a class="menu__link" href="/LaserDB/docs/terminology">术语表</a></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">集群部署</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="机器环境初始化"></a>机器环境初始化<a aria-hidden="true" tabindex="-1" class="hash-link" href="#机器环境初始化" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="中控机"></a>中控机<a aria-hidden="true" tabindex="-1" class="hash-link" href="#中控机" title="Direct link to heading">#</a></h3><ul><li><p>安装 ansible，以 centos 为例:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-shell codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">yum </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> ansible</span></div></div></div></div></div></li><li><p>使用 ssh-keygen 生成公私钥对，默认生成到 ~/.ssh 目录。</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="目标机器（服务运行的机器）"></a>目标机器（服务运行的机器）<a aria-hidden="true" tabindex="-1" class="hash-link" href="#目标机器（服务运行的机器）" title="Direct link to heading">#</a></h3><ul><li><p>服务器需要创建 adbot 用户，并以 adbot 用户运行 sshd 服务，监听 30022 端口，authorized_keys 文件中添加中控机生成的秘钥对中的公钥 id_rsa.pub。</p><p>我们提供了快捷配置脚本，使用如下：</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-shell codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> clone laser-control</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> laser-control/deploy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">vim</span><span class="token plain"> ansible_install_agent.sh </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 将其中的 SSH_PUBLIC_KEY 替换成中控机中生成的秘钥对中的公钥 id_rsa.pub</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sh</span><span class="token plain"> ansible_install_agent.sh</span></div></div></div></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>此快捷配置脚本仅支持 CentOS 7</p></div></div></li><li><p>创建软链 /usr/local/adbot 链接到数据磁盘目录。</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="环境测试"></a>环境测试<a aria-hidden="true" tabindex="-1" class="hash-link" href="#环境测试" title="Direct link to heading">#</a></h3><p>在中控机上运行如下命令：</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-shell codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">su</span><span class="token plain"> adbot</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ssh</span><span class="token plain"> 目标机器IP -p </span><span class="token number" style="color:rgb(247, 140, 108)">30022</span></div></div></div></div></div><p>测试是否能够登陆到目标机器，如果登陆成功，则说明环境配置正确。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="consul-servicename-创建"></a>Consul ServiceName 创建<a aria-hidden="true" tabindex="-1" class="hash-link" href="#consul-servicename-创建" title="Direct link to heading">#</a></h2><p>在 consul 上创建两个服务名 laser_demo 和 laser_demo_replication</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="laser-batch-update-manager-部署"></a>Laser Batch Update Manager 部署<a aria-hidden="true" tabindex="-1" class="hash-link" href="#laser-batch-update-manager-部署" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="配置-laser_batch_update_manager_demoyml"></a>配置 laser_batch_update_manager_demo.yml<a aria-hidden="true" tabindex="-1" class="hash-link" href="#配置-laser_batch_update_manager_demoyml" title="Direct link to heading">#</a></h3><p>laser_batch_update_manager_demo.yml 配置项如下：</p><table><thead><tr><th>变量</th><th>说明</th></tr></thead><tbody><tr><td>package_tag</td><td>laser batch update manager 版本，如 v1.0.1</td></tr><tr><td>package_name</td><td>包名，默认 laser_batch_update_manager</td></tr><tr><td>instance_name</td><td>实例名</td></tr><tr><td>start_options</td><td>启动参数</td></tr><tr><td>ad_core_user</td><td>进程运行的用户</td></tr><tr><td>ad_core_group</td><td>进程运行的组</td></tr><tr><td>http_port</td><td>服务监听的端口号</td></tr><tr><td>hdfs_base_path</td><td>laser 集群批量导入使用的 hdfs 路径</td></tr><tr><td>hdfs_sub_path</td><td>laser hdfs 子目录，这里是 demo 环境，所以子目录为 demo</td></tr><tr><td>hdfs_import_type</td><td>批量导入类型：base - 全量导入，delta - 增量导入，默认 base</td></tr><tr><td>hdfs_hadoop_config_path</td><td>hadoop、hdfs 配置文件路径</td></tr><tr><td>laser_monitor_task_cron</td><td>扫描 laser 数据版本信息的定时任务配置</td></tr><tr><td>laser_dingding_task_cron</td><td>发送钉钉消息定时任务配置</td></tr><tr><td>checksum_monitor_task_cron</td><td>获取 laser 数据版本信息的 checksum 定时任务配置</td></tr><tr><td>dingding_enable</td><td>false</td></tr><tr><td>dingding_secret</td><td>通过 webhook 发送钉钉消息所使用的的秘钥</td></tr><tr><td>dingding_token</td><td>通过 webhook 发送钉钉消息所使用的的token</td></tr></tbody></table><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>laser_batch_update_manager_demo.yml 是一个 ansbile playbook 文件，具体语法请参考 ansible playbook</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="配置-hosts-文件"></a>配置 hosts 文件<a aria-hidden="true" tabindex="-1" class="hash-link" href="#配置-hosts-文件" title="Direct link to heading">#</a></h3><p>在 hosts 文件的 [laser_batch_update_manager_demo] 节下配置 batch update manager 所要部署的机器，</p><p>例如 10.11.11.10</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="执行部署操作"></a>执行部署操作<a aria-hidden="true" tabindex="-1" class="hash-link" href="#执行部署操作" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-shell codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> deploy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">su</span><span class="token plain"> adbot</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ansible-playbook -i hosts laser_batch_update_manager_demo.yml --tags upgrade </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># tags 参数：upgrade-部署更新, start-启动，stop-停止，restart-重启</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="laser-control-部署"></a>Laser Control 部署<a aria-hidden="true" tabindex="-1" class="hash-link" href="#laser-control-部署" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="配置-configyml-文件"></a>配置 config.yml 文件<a aria-hidden="true" tabindex="-1" class="hash-link" href="#配置-configyml-文件" title="Direct link to heading">#</a></h3><p>config.yml 中需要修改的配置项如下：</p><table><thead><tr><th>配置项</th><th>说明</th></tr></thead><tbody><tr><td>consul:address</td><td>consul 地址（如：10.1.2.3:12345）</td></tr><tr><td>consul:token</td><td>consul token</td></tr><tr><td>cluster:serviceName</td><td>例如您的集群服务名是 laser_demo，那么这里填写 demo 即可</td></tr><tr><td>cluster:proxyServiceName</td><td>与 serviceName 相同即可</td></tr><tr><td>batchUpdateManager:url</td><td>batch update manager 服务的url，格式：http://host:port</td></tr><tr><td>ansible:sshPort</td><td>服务运行的机器 sshd 服务监听的端口</td></tr><tr><td>email:emailUser</td><td>您的邮件服务用户名</td></tr><tr><td>email:emailPassword</td><td>您的邮件服务密码</td></tr><tr><td>email:emailSnmpAddress</td><td>smtp 服务地址，格式： host:port</td></tr><tr><td>email:emailFrom</td><td>发件地址</td></tr><tr><td>prometheus:serverPrometheusAddress</td><td>获取 laser server 运行指标的地址，格式：host:port</td></tr><tr><td>prometheus:clientPrometheusAddress</td><td>获取 laser server 机器物理指标的地址，格式：host:port</td></tr></tbody></table><p>开发环境中的 config/config.yml 和部署脚本中的 deploy/roles/laser_control/templates/config.yml 都需要按照上面的说明修改相应配置。 deploy/roles/laser_control/templates/config.yml 中 &quot;{{xxxxx}}&quot; ansible 变量的声明在 deploy/laser_demon_control.yml 中，所以如果需要对这些 ansible 变量的值进行修改，则直接在 deploy/laser_demo_control.yml 修改即可。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="配置-laser_demo_controlyml"></a>配置 laser_demo_control.yml<a aria-hidden="true" tabindex="-1" class="hash-link" href="#配置-laser_demo_controlyml" title="Direct link to heading">#</a></h3><table><thead><tr><th>变量</th><th>说明</th></tr></thead><tbody><tr><td>package_tag</td><td>laser control 版本</td></tr><tr><td>package_name</td><td>包名，默认  laser_control</td></tr><tr><td>instance_name</td><td>laser control 部署的实例名，laser_demon_control</td></tr><tr><td>start_options</td><td>启动参数</td></tr></tbody></table><p>其他参数参考 config.yml 配置文件</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="配置hosts文件"></a>配置hosts文件<a aria-hidden="true" tabindex="-1" class="hash-link" href="#配置hosts文件" title="Direct link to heading">#</a></h3><p>在 deploy/hosts 文件中 [laser_demo_control] 节填入 laser control 要部署的机器IP</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="执行部署操作-1"></a>执行部署操作<a aria-hidden="true" tabindex="-1" class="hash-link" href="#执行部署操作-1" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-shell codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">su</span><span class="token plain"> adbot</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> deploy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ansible-playbook -i hosts laser_demo_control.yml --tags upgrade</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="laser-集群配置部署"></a>Laser 集群配置部署<a aria-hidden="true" tabindex="-1" class="hash-link" href="#laser-集群配置部署" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="登录-laser-control"></a>登录 laser control<a aria-hidden="true" tabindex="-1" class="hash-link" href="#登录-laser-control" title="Direct link to heading">#</a></h3><p>登录 laser control，地址：http://host:port </p><p>host 为 laser control 部署的机器地址，port 为 config.yml 配置文件中的 http:port</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="创建集群"></a>创建集群<a aria-hidden="true" tabindex="-1" class="hash-link" href="#创建集群" title="Direct link to heading">#</a></h3><p>在【集群管理】- 【集群管理】中添加一个示例集群 demo（与 config.yml 文件中的 serviceName 一致）:</p><p><img alt="create_cluster" src="/LaserDB/assets/images/create_cluster-1aa34dce13ad24fe5b2eaa84bcb4fed2.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="创建数据中心"></a>创建数据中心<a aria-hidden="true" tabindex="-1" class="hash-link" href="#创建数据中心" title="Direct link to heading">#</a></h3><p>在【集群管理】-【数据中心】中创建一个默认的数据中心 default:</p><p><img alt="create_dc" src="/LaserDB/assets/images/create_dc-23430b2a618e49ed7009a5605685187d.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="创建节点配置"></a>创建节点配置<a aria-hidden="true" tabindex="-1" class="hash-link" href="#创建节点配置" title="Direct link to heading">#</a></h3><p>在【集群管理】-【节点配置】中增加一个默认的节点配置 default:</p><p><img alt="node_config" src="/LaserDB/assets/images/node_config-582807b13b251acfba645179c8d26e14.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="创建组"></a>创建组<a aria-hidden="true" tabindex="-1" class="hash-link" href="#创建组" title="Direct link to heading">#</a></h3><p>在【集群管理】-【组管理】中添加两个组 group_master 和 group_follower：</p><p>group_master:</p><p><img alt="create_group" src="/LaserDB/assets/images/create_group-50d76b6102e77b3240073e32f30e2ca1.png"></p><p>group_follower:</p><p><img alt="create_group_follower" src="/LaserDB/assets/images/create_group_follower-6e4ac134e2e332839873cebd7bb290e8.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="添加机器分类"></a>添加机器分类<a aria-hidden="true" tabindex="-1" class="hash-link" href="#添加机器分类" title="Direct link to heading">#</a></h3><p>在【机器资源管理】-【机器资源分类】中添加一个机器分类 TestMachines:</p><p><img alt="machine_category" src="/LaserDB/assets/images/machine_category-4c388b48d6869f7ae421e84edf2026b5.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="添加机器资源"></a>添加机器资源<a aria-hidden="true" tabindex="-1" class="hash-link" href="#添加机器资源" title="Direct link to heading">#</a></h3><p>在【机器资源管理】-【机器资源列表】中添加两个机器（10.11.11.11、10.11.11.12）实际配置时请替换成有效的IP地址：</p><p><img alt="add_machines" src="/LaserDB/assets/images/add_machines-92ddc0f56d732e39fb49383680f59fb1.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="添加节点启动配置"></a>添加节点启动配置<a aria-hidden="true" tabindex="-1" class="hash-link" href="#添加节点启动配置" title="Direct link to heading">#</a></h3><p>在【集群管理】-【Ansible 配置】中添加节点启动配置 laser_start_option:</p><table><thead><tr><th>名称</th><th>值</th><th>备注</th></tr></thead><tbody><tr><td>laser_start_option</td><td></td><td></td></tr><tr><td><strong>Roles 配置</strong></td><td></td><td></td></tr><tr><td>service,laser_data_cleaner</td><td></td><td>⚠️ 如果是边缘节点，使用 ramdisk,service,laser_data_cleaner</td></tr><tr><td><strong>Vars 配置</strong></td><td></td><td></td></tr><tr><td>package_tag</td><td>v1.0.1</td><td>laser server  编译的二进制包版本号</td></tr><tr><td>package_name</td><td>laserdb</td><td>包名</td></tr><tr><td>service_name</td><td>laser_demo</td><td>服务名</td></tr><tr><td>replication_service_name</td><td>laser_demo_replication</td><td>主从同步服务名</td></tr><tr><td>http_port</td><td>10030</td><td>http 端口</td></tr><tr><td>thrift_port</td><td>20030</td><td>thrift 端口</td></tr><tr><td>replicator_port</td><td>30030</td><td>主从同步端口</td></tr><tr><td>consul_addresses</td><td>10.11.11.20:8500</td><td>consul 地址</td></tr><tr><td>hdfs_check_url</td><td><a href="http://10.11.11.10:8080/checksum" target="_blank" rel="noopener noreferrer">http://10.11.11.10:8080/checksum</a></td><td>版本检查服务端口</td></tr><tr><td>hdfs_data_dir</td><td>/dw_ext/ad/ads_core/laser/demo</td><td>hdfs 数据目录</td></tr><tr><td>start_options</td><td>-hadoop_path=/usr/local/hadoop-2.7.3/bin/hadoop --service-name={{service_name}} --router_consul_addresses={{consul_addresses}} --http-port={{http_port}} --port={{thrift_port}} --replicator_port={{replicator_port}} -data_dir=/usr/local/adbot/{{instance_name}}/data -hdfs_monitor_interval=30000 --call_hdfs_metadata_flag=true --call_hdfs_metadata_url={{hdfs_check_url}} --group-name={{group_name}} --node-id={{node_id}} --dc={{dc}} -laser_hdfs_data_dir={{hdfs_data_dir}}  -vmodule=&#x27;hdfsmonitor=0,partition_handler=0,replication_db=0&#x27; --replicator_max_updates_per_response=500 -replicator_service_name={{replication_service_name}} -wdt_global_receiver_limit=50 -loader_thread_nums=16 -wdt_replicator_abort_timeout_ms=6000000 -wdt_overwrite=true -wdt_ipv4=true -wdt_encryption_type=none -wdt_accept_timeout_millis=30000 -wdt_accept_window_millis=20000 -wdt_connect_timeout_millis=10000 -idle_timeout=86400000 -http_server_work_thread_num=16 -wdt_max_mbytes_per_sec=400 --replication_reverse_mode_enable=false --delay_set_available_seconds=1</td><td>启动参数</td></tr><tr><td>instance_name</td><td>laser_demo_server</td><td>实例名</td></tr><tr><td>other_env</td><td>JAVA_HOME=&quot;/usr/local/jdk1.8.0_131&quot;</td><td>其他环境变量</td></tr><tr><td>clean_hour</td><td>*/1</td><td></td></tr><tr><td>clean_minute</td><td>20</td><td></td></tr><tr><td>ramdisk_size</td><td>96G</td><td>⚠️  ⚠️ ⚠️ 仅边缘节点或者内存池使用，普通节点无需增加此配置项	​​</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="添加节点"></a>添加节点<a aria-hidden="true" tabindex="-1" class="hash-link" href="#添加节点" title="Direct link to heading">#</a></h3><p>在【集群管理】-【节点管理】-【主副本】中添加一个主节点，配置如下：</p><table><thead><tr><th>配置名称</th><th>配置值</th></tr></thead><tbody><tr><td>所属组</td><td>group_master</td></tr><tr><td>节点Id</td><td>1</td></tr><tr><td>地址</td><td>10.11.11.11 (请替换成有效的IP地址)</td></tr><tr><td>端口</td><td>10030</td></tr><tr><td>配置</td><td>default</td></tr><tr><td>启动配置</td><td>laser_start_option</td></tr><tr><td>主节点</td><td>是</td></tr><tr><td>边缘节点</td><td>否</td></tr><tr><td>激活</td><td>是</td></tr><tr><td>主分片列表</td><td>0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023</td></tr></tbody></table><p><img alt="add_master_node" src="/LaserDB/assets/images/add_master_node-5105055340332f3564bc17d73e78377a.png"></p><p>在【集群管理】-【节点管理】-【从副本】中添加一个从节点，配置如下：</p><table><thead><tr><th>配置名称</th><th align="left">配置值</th></tr></thead><tbody><tr><td>所属组</td><td align="left">group_follower</td></tr><tr><td>节点Id</td><td align="left">1</td></tr><tr><td>地址</td><td align="left">10.11.11.12 (请替换成有效的IP地址)</td></tr><tr><td>端口</td><td align="left">10030</td></tr><tr><td>配置</td><td align="left">default</td></tr><tr><td>启动配置</td><td align="left">laser_start_option</td></tr><tr><td>主节点</td><td align="left">否</td></tr><tr><td>边缘节点</td><td align="left">否</td></tr><tr><td>激活</td><td align="left">是</td></tr><tr><td>从分片列表</td><td align="left">0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023</td></tr></tbody></table><p><img alt="add_follower_node" src="/LaserDB/assets/images/add_follower_node-404c001c45be7883133f305585bcea6c.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="集群配置同步"></a>集群配置同步<a aria-hidden="true" tabindex="-1" class="hash-link" href="#集群配置同步" title="Direct link to heading">#</a></h3><p>在【集群管理】-【集群管理】中点击【同步】按钮，上传集群配置信息</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>每次增加、修改、删除集群、节点的相关信息或者配置，都要点击 【同步】按钮，才会在 laser 集群生效</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="启动节点"></a>启动节点<a aria-hidden="true" tabindex="-1" class="hash-link" href="#启动节点" title="Direct link to heading">#</a></h3><p>在【集群管理】-【节点管理】中，在节点删点击【更新】按钮，开始部署启动节点：</p><p><img alt="start_master" src="/LaserDB/assets/images/start_master-b9a4d9ab721376b3789a482d8831b90d.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="表配置"></a>表配置<a aria-hidden="true" tabindex="-1" class="hash-link" href="#表配置" title="Direct link to heading">#</a></h3><p>在【数据管理】-【表配置模板】里填入默认的表配置（default），默认配置项如下：</p><table><thead><tr><th>DbOptions</th><th></th></tr></thead><tbody><tr><td>配置项名称</td><td>配置项值</td></tr><tr><td>create_if_missing</td><td>true</td></tr><tr><td>max_background_flushes</td><td>20</td></tr><tr><td>max_background_compactions</td><td>20</td></tr><tr><td>WAL_ttl_seconds</td><td>3600</td></tr><tr><td>WAL_size_limit_MB</td><td>512</td></tr><tr><td>use_direct_reads</td><td>true</td></tr><tr><td>compaction_readahead_size</td><td>2097152</td></tr><tr><td><strong>TableOptions</strong></td><td></td></tr><tr><td>配置项名称</td><td>配置项值</td></tr><tr><td>filter_policy</td><td>bloomfilter:10:false</td></tr><tr><td>index_type</td><td>kTwoLevelIndexSearch</td></tr><tr><td>data_block_index_type</td><td>kDataBlockBinaryAndHash</td></tr><tr><td>partition_filters</td><td>true</td></tr><tr><td>metadata_block_size</td><td>4096</td></tr><tr><td>cache_index_and_filter_blocks_with_high_priority</td><td>true</td></tr><tr><td>cache_index_and_filter_blocks</td><td>true</td></tr><tr><td>pin_l0_filter_and_index_blocks_in_cache</td><td>true</td></tr><tr><td>block_size</td><td>65536</td></tr><tr><td><strong>CfOptions</strong></td><td></td></tr><tr><td>配置项名称</td><td>配置项值</td></tr><tr><td>num_levels</td><td>7</td></tr></tbody></table><p><img alt="table_config_template" src="/LaserDB/assets/images/table_config_template-0928e2b77a7a55d5baec04a1196d5237.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="创建数据库"></a>创建数据库<a aria-hidden="true" tabindex="-1" class="hash-link" href="#创建数据库" title="Direct link to heading">#</a></h3><p>在【数据管理】-【数据库管理】中创建一个测试数据库 test:</p><p><img alt="create_db" src="/LaserDB/assets/images/create_db-48501dee63ddb69c138f189431163483.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="创建数据表"></a>创建数据表<a aria-hidden="true" tabindex="-1" class="hash-link" href="#创建数据表" title="Direct link to heading">#</a></h3><p>在【数据管理】-【数据库管理】中创建一个测试数据表 test:</p><p><img alt="create_table" src="/LaserDB/assets/images/create_table-9ce4f48cade3aef95402ced7f4ba91b4.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="同步表信息"></a>同步表信息<a aria-hidden="true" tabindex="-1" class="hash-link" href="#同步表信息" title="Direct link to heading">#</a></h3><p>在【数据管理】-【数据表管理】中点击【同步】按钮，同步表信息</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>每次增加、修改、删除表的相关信息或者配置，都要点击 【同步】按钮，才会在 laser 集群生效</p></div></div><p>至此，laser 集群已经部署完成，后续增加节点或者增加表，按上述步骤操作即可。</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/cluster-deploy.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/LaserDB/docs/comparison-to-alternatives"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 常见数据库对比</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/LaserDB/docs/cluster-config"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">集群配置 »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#机器环境初始化" class="table-of-contents__link">机器环境初始化</a><ul><li><a href="#中控机" class="table-of-contents__link">中控机</a></li><li><a href="#目标机器（服务运行的机器）" class="table-of-contents__link">目标机器（服务运行的机器）</a></li><li><a href="#环境测试" class="table-of-contents__link">环境测试</a></li></ul></li><li><a href="#consul-servicename-创建" class="table-of-contents__link">Consul ServiceName 创建</a></li><li><a href="#laser-batch-update-manager-部署" class="table-of-contents__link">Laser Batch Update Manager 部署</a><ul><li><a href="#配置-laser_batch_update_manager_demoyml" class="table-of-contents__link">配置 laser_batch_update_manager_demo.yml</a></li><li><a href="#配置-hosts-文件" class="table-of-contents__link">配置 hosts 文件</a></li><li><a href="#执行部署操作" class="table-of-contents__link">执行部署操作</a></li></ul></li><li><a href="#laser-control-部署" class="table-of-contents__link">Laser Control 部署</a><ul><li><a href="#配置-configyml-文件" class="table-of-contents__link">配置 config.yml 文件</a></li><li><a href="#配置-laser_demo_controlyml" class="table-of-contents__link">配置 laser_demo_control.yml</a></li><li><a href="#配置hosts文件" class="table-of-contents__link">配置hosts文件</a></li><li><a href="#执行部署操作-1" class="table-of-contents__link">执行部署操作</a></li></ul></li><li><a href="#laser-集群配置部署" class="table-of-contents__link">Laser 集群配置部署</a><ul><li><a href="#登录-laser-control" class="table-of-contents__link">登录 laser control</a></li><li><a href="#创建集群" class="table-of-contents__link">创建集群</a></li><li><a href="#创建数据中心" class="table-of-contents__link">创建数据中心</a></li><li><a href="#创建节点配置" class="table-of-contents__link">创建节点配置</a></li><li><a href="#创建组" class="table-of-contents__link">创建组</a></li><li><a href="#添加机器分类" class="table-of-contents__link">添加机器分类</a></li><li><a href="#添加机器资源" class="table-of-contents__link">添加机器资源</a></li><li><a href="#添加节点启动配置" class="table-of-contents__link">添加节点启动配置</a></li><li><a href="#添加节点" class="table-of-contents__link">添加节点</a></li><li><a href="#集群配置同步" class="table-of-contents__link">集群配置同步</a></li><li><a href="#启动节点" class="table-of-contents__link">启动节点</a></li><li><a href="#表配置" class="table-of-contents__link">表配置</a></li><li><a href="#创建数据库" class="table-of-contents__link">创建数据库</a></li><li><a href="#创建数据表" class="table-of-contents__link">创建数据表</a></li><li><a href="#同步表信息" class="table-of-contents__link">同步表信息</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">文档</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/LaserDB/docs/">关于 LaserDB</a></li><li class="footer__item"><a class="footer__link-item" href="/LaserDB/docs/getting-started">快速上手</a></li><li class="footer__item"><a class="footer__link-item" href="/LaserDB/docs/reference/data-model">参考指南</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/LaserDB/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2021 LaserDB.</div></div></div></footer></div>
<script src="/LaserDB/styles.42bb82b0.js"></script>
<script src="/LaserDB/runtime~main.e1fb6fb2.js"></script>
<script src="/LaserDB/main.7618bfdc.js"></script>
<script src="/LaserDB/1.39450f4e.js"></script>
<script src="/LaserDB/2.80131b89.js"></script>
<script src="/LaserDB/42.e8a2d4b5.js"></script>
<script src="/LaserDB/43.a364796b.js"></script>
<script src="/LaserDB/935f2afb.49568513.js"></script>
<script src="/LaserDB/17896441.c3acda63.js"></script>
<script src="/LaserDB/2ace4267.aacdcd4c.js"></script>
</body>
</html>